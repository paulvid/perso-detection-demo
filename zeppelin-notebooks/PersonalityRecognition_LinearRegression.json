{"paragraphs":[{"text":"%pyspark\n\n\nfrom pyspark.sql.functions import lit\narticle_evaluation_table = sqlContext.read \\\n  .format(\"org.apache.phoenix.spark\") \\\n  .option(\"table\", \"article_evaluation\") \\\n  .option(\"zkUrl\", \"localhost:2181\") \\\n  .load()\narticle_stats_table = sqlContext.read \\\n  .format(\"org.apache.phoenix.spark\") \\\n  .option(\"table\", \"article_stats\") \\\n  .option(\"zkUrl\", \"localhost:2181\") \\\n  .load()\naet = article_evaluation_table.alias('aet')\nast = article_stats_table.alias('ast')\ninner_join = aet.join(ast, aet.WEB_URL == ast.WEB_URL)\narticle_df = inner_join.select('EXTRAVERSION','OPENNESS_TO_EXPERIENCE','CONSCIENTIOUSNESS','AGREEABLENESS','EMOTIONAL_STABILITY','VIEWS')\nno_views_df = article_evaluation_table.select('WEB_URL','EXTRAVERSION','OPENNESS_TO_EXPERIENCE','CONSCIENTIOUSNESS','AGREEABLENESS','EMOTIONAL_STABILITY').withColumn('VIEWS',lit(0))\n\n","user":"admin","dateUpdated":"2018-10-30T12:50:33+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1540901384799_-482665487","id":"20181002-191945_765090209","dateCreated":"2018-10-30T12:09:44+0000","dateStarted":"2018-10-30T12:50:33+0000","dateFinished":"2018-10-30T12:50:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:10976"},{"text":"%pyspark\nfrom pyspark.ml.feature import VectorAssembler\nvectorAssembler = VectorAssembler(inputCols = ['EXTRAVERSION', 'OPENNESS_TO_EXPERIENCE', 'CONSCIENTIOUSNESS', 'AGREEABLENESS', 'EMOTIONAL_STABILITY'], outputCol = 'features')\nvtrainingDF = vectorAssembler.transform(article_df)\nvarticle_df = vtrainingDF.select(['features', 'VIEWS'])\nvno_views_df = vectorAssembler.transform(no_views_df)\ntrain_df = varticle_df","user":"admin","dateUpdated":"2018-10-30T12:50:38+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1540901384809_82562788","id":"20181002-192721_1842018393","dateCreated":"2018-10-30T12:09:44+0000","dateStarted":"2018-10-30T12:50:38+0000","dateFinished":"2018-10-30T12:50:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10977"},{"text":"%pyspark\n\nfrom pyspark.ml.regression import LinearRegression\n\nlr = LinearRegression(featuresCol = 'features', labelCol='VIEWS', maxIter=10, regParam=0.3, elasticNetParam=0.8)\nlr_model = lr.fit(train_df)\nprint(\"Coefficients: \" + str(lr_model.coefficients))\nprint(\"Intercept: \" + str(lr_model.intercept))","user":"admin","dateUpdated":"2018-10-30T12:50:41+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Coefficients: [0.0,0.0,0.0,0.0,0.0]\nIntercept: 12.0\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://seregion-sharedservices0.field.hortonworks.com:4040/jobs/job?id=5","http://seregion-sharedservices0.field.hortonworks.com:4040/jobs/job?id=6","http://seregion-sharedservices0.field.hortonworks.com:4040/jobs/job?id=7","http://seregion-sharedservices0.field.hortonworks.com:4040/jobs/job?id=8","http://seregion-sharedservices0.field.hortonworks.com:4040/jobs/job?id=9","http://seregion-sharedservices0.field.hortonworks.com:4040/jobs/job?id=10","http://seregion-sharedservices0.field.hortonworks.com:4040/jobs/job?id=11","http://seregion-sharedservices0.field.hortonworks.com:4040/jobs/job?id=12","http://seregion-sharedservices0.field.hortonworks.com:4040/jobs/job?id=13"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1540901384811_-404117725","id":"20181002-193110_1815277664","dateCreated":"2018-10-30T12:09:44+0000","dateStarted":"2018-10-30T12:50:41+0000","dateFinished":"2018-10-30T12:51:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10978"},{"text":"%pyspark\n\ntrainingSummary = lr_model.summary\nprint(\"RMSE: %f\" % trainingSummary.rootMeanSquaredError)\nprint(\"r2: %f\" % trainingSummary.r2)\ntrain_df.describe().show()","user":"admin","dateUpdated":"2018-10-30T12:51:06+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"RMSE: 0.000000\nr2: nan\n+-------+-----+\n|summary|VIEWS|\n+-------+-----+\n|  count|    1|\n|   mean| 12.0|\n| stddev|  NaN|\n|    min|   12|\n|    max|   12|\n+-------+-----+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://seregion-sharedservices0.field.hortonworks.com:4040/jobs/job?id=14"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1540901384811_2046933261","id":"20181002-193137_488967512","dateCreated":"2018-10-30T12:09:44+0000","dateStarted":"2018-10-30T12:51:06+0000","dateFinished":"2018-10-30T12:51:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10979"},{"text":"%pyspark\npredictions = lr_model.transform(vno_views_df)\ndf_to_write = predictions.select(\"WEB_URL\",\"EXTRAVERSION\",\"OPENNESS_TO_EXPERIENCE\",\"CONSCIENTIOUSNESS\",\"AGREEABLENESS\",\"EMOTIONAL_STABILITY\",\"prediction\")","user":"admin","dateUpdated":"2018-10-30T12:51:13+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1540901384812_1518015007","id":"20181002-193317_1081185975","dateCreated":"2018-10-30T12:09:44+0000","dateStarted":"2018-10-30T12:51:14+0000","dateFinished":"2018-10-30T12:51:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10980"},{"text":"%pyspark\n\ndf_to_write.write \\\n  .format(\"org.apache.phoenix.spark\") \\\n  .mode(\"overwrite\") \\\n  .option(\"table\", \"article_popularity_prediction\") \\\n  .option(\"zkUrl\", \"localhost:2181\") \\\n  .save()","user":"admin","dateUpdated":"2018-10-30T12:51:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://seregion-sharedservices0.field.hortonworks.com:4040/jobs/job?id=15"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1540901384813_-41134357","id":"20181002-193419_1354097","dateCreated":"2018-10-30T12:09:44+0000","dateStarted":"2018-10-30T12:51:26+0000","dateFinished":"2018-10-30T12:51:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10981"},{"text":"%jdbc(phoenix)\n\n\nselect  article_popularity_prediction.web_url as URL,\n        article_popularity_prediction. prediction as predicted_views,\n        article_stats.views\nfrom    article_popularity_prediction, article_stats\nwhere   article_popularity_prediction.web_url = article_stats.web_url\n","user":"admin","dateUpdated":"2018-10-30T12:54:22+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"multiBarChart","height":478.125,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"URL":"string","PREDICTED_VIEWS":"string","ARTICLE_STATS.VIEWS":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"rotate"}},"commonSetting":{},"keys":[{"name":"URL","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"PREDICTED_VIEWS","index":1,"aggr":"sum"},{"name":"ARTICLE_STATS.VIEWS","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"URL\tPREDICTED_VIEWS\tARTICLE_STATS.VIEWS\nhttps://www.nytimes.com/2018/10/29/us/north-carolina-school-shooting.html\t12.0\t12\n"}]},"apps":[],"jobName":"paragraph_1540901384814_-332814398","id":"20181002-194705_1318490767","dateCreated":"2018-10-30T12:09:44+0000","dateStarted":"2018-10-30T12:51:31+0000","dateFinished":"2018-10-30T12:51:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10982"},{"text":"%jdbc\n","user":"admin","dateUpdated":"2018-10-30T12:09:44+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1540901384814_260618524","id":"20181004-130716_838592660","dateCreated":"2018-10-30T12:09:44+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:10983"}],"name":"Personality Recognition/Linear Regression","id":"2DTRZYF89","noteParams":{},"noteForms":{},"angularObjects":{"jdbc:shared_process":[],"spark2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}